# ðŸŽ·æ“ä½œç³»ç»Ÿ

## ðŸ¤¡ 4. å­˜å‚¨å™¨ç®¡ç†
### 4.1 å­˜å‚¨å™¨å±‚æ¬¡ç»“æž„
> ðŸ“Œ **åŸºæœ¬æ¦‚å¿µ**

![image.png](https://i.loli.net/2019/12/15/Go4r7JgSH6zVORQ.png)

> âš¡ **ä¹ é¢˜**

![image.png](https://i.loli.net/2019/12/15/bN61LUefupPqG7T.png)

### 4.2 ç¨‹åºçš„è£…å…¥å’Œé“¾æŽ¥
> ðŸ“Œ **åŸºæœ¬æ¦‚å¿µ**
1. ç”¨æˆ·æºç¨‹åº -> å†…å­˜ä¸­å¯æ‰§è¡Œç¨‹åº
    + ç¼–è¯‘ï¼šæºç¨‹åº -> è‹¥å¹²ç›®æ ‡æ¨¡å—
    + é“¾æŽ¥ï¼šç›®æ ‡æ¨¡å— -> è£…å…¥æ¨¡å—
    + è£…å…¥ï¼šè£…å…¥æ¨¡å— -> å†…å­˜
![image.png](https://i.loli.net/2019/12/16/AHhyqmoJdOjcUS8.png)

2. ç›¸å…³åè¯
    + é€»è¾‘åœ°å€(ç›¸å¯¹åœ°å€ï¼Œè™šåœ°å€)
    + ç‰©ç†åœ°å€(ç»å¯¹åœ°å€ï¼Œå®žåœ°å€)
    + åœ°å€æ˜ å°„(åœ°å€è½¬æ¢)

3. è£…å…¥æ–¹å¼
    + ç»å¯¹è£…å…¥æ–¹å¼
        - ç¨‹åºé€»è¾‘åœ°å€ä¸Žå®žé™…å†…å­˜ä¸­åœ°å€å®Œå…¨ç›¸åŒï¼Œæ— éœ€ä¿®æ”¹
        - é€‚ç”¨äºŽå•é“ç¨‹åºçŽ¯å¢ƒ
        - å¯ç¼–è¯‘æ—¶ç»™å‡ºï¼Œä¹Ÿå¯ç”±ç¨‹åºå‘˜ç›´æŽ¥èµ‹
    + å¯é‡å®šä½è£…å…¥æ–¹å¼(**é™æ€é‡å®šä½**)
        - é€»è¾‘åœ°å€ä¸Žå†…å­˜ç‰©ç†åœ°å€ä¸ä¸€è‡´
        - è£…å…¥æ—¶è¿›è¡Œåœ°å€è½¬æ¢
        - ä¸å…è®¸ç¨‹åºè¿è¡Œæ—¶åœ¨å†…å­˜ä¸­ç§»åŠ¨ä½ç½®
        - ä¸€æ¬¡æ€§å®Œæˆ
        - è½¯ä»¶å®Œæˆ
    + åŠ¨æ€è¿è¡Œæ—¶è£…å…¥æ–¹å¼(**åŠ¨æ€é‡å®šä½**)
        - ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­è¦è®¿é—®æ•°æ®è¿›è¡Œåœ°å€å˜æ¢
        - è½¯ç¡¬(*é‡å®šä½å¯„å­˜å™¨*)ä»¶ç»“åˆå®Œæˆ

*ps.åŠ¨æ€ä¸Žé™æ€çš„åŒºåˆ«åœ¨äºŽï¼ŒåŠ¨æ€åªæ˜¯æŠŠ**ç›¸å¯¹åœ°å€åˆ°ç»å¯¹åœ°å€çš„è½¬æ¢**æŽ¨è¿Ÿåˆ°ç¨‹åºçœŸæ­£æ‰§è¡Œæ—¶è¿›è¡Œ* 

4. é“¾æŽ¥
    + é™æ€é“¾æŽ¥
        - ç¼ºé™·ï¼š
            - ä¸ä¾¿äºŽç›®æ ‡æ¨¡å—ä¿®æ”¹ï¼Œæ›´æ–°å’Œå…±äº«
    + è£…å…¥æ—¶åŠ¨æ€é“¾æŽ¥
        - è¾¹è£…å…¥ï¼Œè¾¹é“¾æŽ¥
        - è§£å†³é™æ€é“¾æŽ¥çš„é—®é¢˜
        - ç¼ºé™·ï¼š
            - å°†ä¸éœ€è¦çš„æ¨¡å—ä¹Ÿé“¾æŽ¥è¿›åŽ»
    + è¿è¡Œæ—¶åŠ¨æ€é“¾æŽ¥
        - è§£å†³ä¸Šè¿°é“¾æŽ¥æ–¹å¼çš„ç¼ºé™·
        - é«˜æ•ˆçœç©ºé—´
> âš¡ **ä¹ é¢˜**

### 4.3 è¿žç»­åˆ†é…å­˜å‚¨ç®¡ç†æ–¹å¼

> ðŸ“Œ **åŸºæœ¬æ¦‚å¿µ**
1. è¿žç»­åˆ†é…æ–¹å¼
    - é™æ€åˆ†åŒº
        + å•ä¸€è¿žç»­åˆ†åŒºåˆ†é…
            - å­˜å‚¨ç®¡ç†æ–¹æ³•ï¼šå†…å­˜ä½Žç«¯ä¸ºç³»ç»ŸåŒºï¼Œé«˜ç«¯ä¸ºç”¨æˆ·åŒº
            - ä½œä¸šè¿›å…¥å†…å­˜ï¼Œå¿…é¡»ç­‰å¾…è¿è¡Œç»“æŸæ‰èƒ½é‡Šæ”¾(é™æ€åˆ†é…)
            - åªèƒ½ç”¨äºŽå•ç”¨æˆ·ï¼Œå•ä»»åŠ¡çš„os
            - ä¸»è¦ç‰¹ç‚¹ï¼šç®¡ç†ç®€å•ï¼Œä½†åªèƒ½è£…å…¥ä¸€é“ä½œä¸šï¼Œå†…å­˜ç©ºé—´æµªè´¹å¤§ï¼Œèµ„æºåˆ©ç”¨çŽ‡ä½Ž
            - ![image.png](https://i.loli.net/2019/12/16/ylzNHYGXZM3nKeT.png)
        + å›ºå®šåˆ†åŒºåˆ†é…
            - æœ€æ—©ä½¿ç”¨å¯è¿è¡Œå¤šé“ç¨‹åºå­˜å‚¨ç®¡ç†æ–¹æ³•
            - åˆ†åŒºå¤§å°åŠè¾¹ç•Œåœ¨è¿è¡Œæ—¶ä¸å¯æ›´æ”¹(é™æ€åˆ†åŒºçš„ç‰¹æ€§)
            - ç³»ç»Ÿéœ€åˆ†åŒºä½¿ç”¨è¡¨
            - åˆ†åŒºåˆ’åˆ†ï¼š
                + åˆ†åŒºå¤§å°ç›¸ç­‰
                + åˆ†åŒºå¤§å°ä¸ç­‰
    - åŠ¨æ€åˆ†åŒº
        + åŠ¨æ€åˆ†åŒºåˆ†é…
            - æ ¹æ®éœ€æ±‚åˆ†é…ç©ºé—´
            - ç®¡ç†ç®€å•ï¼Œä¸»å­˜åˆ©ç”¨çŽ‡è¾ƒé™æ€æœ‰æ‰€æé«˜
            - æ•°æ®ç»“æž„ï¼š
                + ç©ºé—²åˆ†åŒºè¡¨
                    ç™»è®°ç©ºé—²åˆ†åŒºï¼ˆè¯¦ç»†ä¿¡æ¯ï¼‰
                + ç©ºé—²åˆ†åŒºé“¾
                    ![image.png](https://i.loli.net/2019/12/16/6AXUl4fz8cL3aiv.png)
            - åˆ†é…å†…å­˜æ“ä½œ
                ![image.png](https://i.loli.net/2019/12/17/7WgM1w95JrEdAFG.png)
            - å›žæ”¶å†…å­˜
                + åˆå¹¶ðŸŽ
        + åŠ¨æ€å¯é‡å®šå‘åˆ†åŒºåˆ†é…
            - åŸºäºŽ **é¡ºåºæœç´¢** çš„åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³•
                + é¦–æ¬¡é€‚åº”ç®—æ³•(First Fit)
                    - ![image.png](https://i.loli.net/2019/12/17/5d38goO7KhEXmHr.png)
                    - ![image.png](https://i.loli.net/2019/12/17/42keFnBKVitAcQ1.png)
                + å¾ªçŽ¯é¦–æ¬¡é€‚åº”ç®—æ³•(Next Fit)
                    - ä»Žä¸Šæ¬¡æ‰¾åˆ°çš„ç©ºé—²åˆ†åŒºçš„ä¸‹ä¸€ä¸ªç©ºé—²åˆ†åŒºå¼€å§‹æŸ¥æ‰¾
                    - ![image.png](https://i.loli.net/2019/12/17/KdYtJS9vywBObMc.png)
                + æœ€ä½³é€‚åº”ç®—æ³•(Best Fit)
                    - ![image.png](https://i.loli.net/2019/12/17/T7YFeRIV1OQJ3na.png)
                    - ç‰¹ç‚¹ç®€è¯´å°±æ˜¯ï¼Œå¤§å°è¿‘ä¼¼åˆ†é…è¾ƒokï¼Œä½†ä¼šäº§ç”Ÿç¢Žç‰‡
                + æœ€åé€‚åº”ç®—æ³•(Worstt Fit)
                    - ![image.png](https://i.loli.net/2019/12/17/jbs5SNh1gOXQe72.png)
                    - ç¼ºé™·æ¥è¯´ï¼Œå¤§ä½œä¸šæ¥æ—¶ï¼Œå¾ˆå¯èƒ½å¾—ä¸åˆ°æ»¡è¶³

            - åŸºäºŽ **ç´¢å¼•æœç´¢** çš„åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³•
                + å¿«é€Ÿé€‚åº”ç®—æ³•(Quick Fit)
                    - ![image.png](https://i.loli.net/2019/12/17/csvxok3IdgYUtEz.png)

                + ä¼™ä¼´ç³»ç»Ÿ(Buddy system)
                    - ![image.png](https://i.loli.net/2019/12/17/ZVspxSnh4laJWH9.png)
                    - ![image.png](https://i.loli.net/2019/12/17/5qb2LSodcy8MaeZ.png)
                    - ![image.png](https://i.loli.net/2019/12/17/dFXJPpOMcowZr2T.png)
                    - ![image.png](https://i.loli.net/2019/12/17/vU6Cx9IZMWOFbgR.png)


                + å“ˆå¸Œç®—æ³•
                    - ![image.png](https://i.loli.net/2019/12/17/6aeBshnTi4SkbPH.png)
                    - ![image.png](https://i.loli.net/2019/12/17/1Mu5qH6D8UgQSYR.png)


2. ç³»ç»Ÿç¢Žç‰‡
    + å†…éƒ¨ç¢Žç‰‡
        - æŒ‡åˆ†é…ç»™ä½œä¸šçš„å­˜å‚¨ç©ºé—´ä¸­è¿èƒŒåˆ©ç”¨çš„éƒ¨åˆ†
        - å‘ç”Ÿåœºæ™¯
            + å•ä¸€è¿žç»­åŒºå­˜å‚¨ç®¡ç†
            + å›ºå®šåˆ†åŒºå­˜å‚¨ç®¡ç†
            + åˆ†é¡µæ˜¯å­˜å‚¨ç®¡ç†
            + è¯·æ±‚é¡µå¼å­˜å‚¨ç®¡ç†
    + å¤–éƒ¨ç¢Žç‰‡
        - æŒ‡ç³»ç»Ÿä¸­æ— æ³•åˆ©ç”¨çš„å°çš„ç©ºé—²åˆ†åŒºã€‚å¦‚åˆ†åŒºä¹‹é—´å­˜åœ¨çš„ç¢Žç‰‡ã€‚
        - **é€ æˆå†…å­˜ç³»ç»Ÿæ€§èƒ½ä¸‹é™çš„ä¸»è¦åŽŸå› **
    + ç¢Žç‰‡è§£å†³æŠ€æœ¯
        - ç´§å‡‘æŠ€æœ¯(Compacting)
            - é€šè¿‡**ç§»åŠ¨ä½œä¸š**ä»ŽæŠŠå¤šä¸ªåˆ†æ•£çš„å°åˆ†åŒºæ‹¼æŽ¥æˆä¸€ä¸ªå¤§åˆ†åŒºçš„æ–¹æ³•
            - ç´§å‡‘æ—¶æœºï¼šæ‰¾ä¸åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—²åˆ†åŒºä¸”æ€»ç©ºé—²åˆ†åŒºå¯ä»¥æ»¡è¶³ä½œä¸šè¦æ±‚æ—¶
        - ä¸Žå†…å­˜å›žæ”¶ä¸åŒçš„æ˜¯ï¼Œå†…å­˜å›žæ”¶åªæ˜¯å°†ç›¸é‚»çš„ç©ºé—²åˆ†åŒºåˆå¹¶ï¼Œè€Œç´§å‡‘æŠ€æœ¯æ˜¯ç§»åŠ¨ä½œä¸šä½ç½®ï¼Œå°†ç©ºé—²åˆ†åŒºæŽ’åœ¨ä¸€å †å†è¿›è¡Œåˆå¹¶
        - ![image.png](https://i.loli.net/2019/12/17/U3y2GtT4dPBqcDE.png)
    
3. åˆ†åŒºå­˜å‚¨ä¿æŠ¤
    + ![image.png](https://i.loli.net/2019/12/17/E3XiPIR2fa7uUjH.png)
    
> âš¡ **ä¹ é¢˜**
1. å›ºå®šåˆ†åŒºåˆ†é…
![image.png](https://i.loli.net/2019/12/16/weISpuWmiCVAtq3.png)
![image.png](https://i.loli.net/2019/12/16/uqQgZCGeLAzcjpM.png)

### 4.4 è¦†ç›–ä¸Žå¯¹æ¢

> ðŸ“Œ **åŸºæœ¬æ¦‚å¿µ**

1. è¦†ç›–ä¸Žå¯¹æ¢
    + è¦†ç›–(Overlay)
        - ![image.png](https://i.loli.net/2019/12/17/GqSoNUd7lcVwIhC.png)

    + å¯¹æ¢(Swapping)
        - ![image.png](https://i.loli.net/2019/12/17/m1MIVJOi39kDdLW.png)
    
    + åŒºåˆ«
        - ![image.png](https://i.loli.net/2019/12/17/KrOBxLIf5nzv61c.png)

> âš¡ **ä¹ é¢˜**

### 4.5 ç¦»æ•£åˆ†é…æ–¹å¼

> ðŸ“Œ **åŸºæœ¬æ¦‚å¿µ**
1. åŸºæœ¬åè¯æ¦‚å¿µ
    + é¡µé¢ä¸Žç‰©ç†å—çš„åŒºåˆ«
        - é¡µé¢ï¼šé€»è¾‘ç©ºé—´ï¼Œå„é¡µé¢ä»Ž0å¼€å§‹
        - ç‰©ç†å—ï¼šç‰©ç†ç©ºé—´ï¼Œå¤§å°ä¸Žé¡µé¢ç›¸ç­‰ï¼Œä¹Ÿæ˜¯ä»Ž0å¼€å§‹ç¼–å·
    + äºŒè€…å†…å­˜åˆ†é…
        - å°†è¿›ç¨‹ä¸­çš„è‹¥å¹²é¡µé¢è£…å…¥åˆ°å¤šä¸ªä¸ç›¸é‚»çš„å—ä¸­ï¼Œæœ€åŽä¸€é¡µå¸¸å¸¸è£…ä¸æ»¡è€Œå‡ºçŽ°**é¡µå†…ç¢Žç‰‡**
    + é¡µè¡¨
        - æ¯ä¸€é¡µï¼Œåœ¨é¡µè¡¨ä¸­éƒ½å¯¹åº”æœ‰ä¸€ä¸ªé¡µè¡¨é¡¹
        - å­˜æ”¾åœ¨å†…å­˜ä¹‹ä¸­ï¼Œå±žäºŽè¿›ç¨‹çŽ°åœºä¿¡æ¯
        - ç”¨é€”
            + è®°å½•è¿›ç¨‹åˆ†é…
            + å®žçŽ°è¿›ç¨‹è¿è¡Œæ—¶çš„åŠ¨æ€é‡å®šä½
        - **è®¿é—®ä¸€ä¸ªæ•°æ®éœ€è¦è®¿é—®å†…å­˜2æ¬¡(é¡µè¡¨ä¸€æ¬¡ï¼Œå†…å­˜ä¸€æ¬¡)**
        - é¡µè¡¨åŸºå€åŠé•¿åº¦ç”±é¡µè¡¨å¯„å­˜å™¨(PTR,Page-Table Register)ç»™å‡º
        ![image.png](https://i.loli.net/2019/12/18/IKelypD5t3UNaJ6.png)
        ![image.png](https://i.loli.net/2019/12/18/QX9MNhBoYVy6zqU.png)
        - **è¾ƒä¸ºé‡è¦çš„æ¦‚å¿µ**
        ![image.png](https://i.loli.net/2019/12/18/IusZxX4fMOPagB1.png)
        
    + åœ°å€å˜æ¢æœºæž„
        - åŸºæœ¬åœ°å€å˜åŒ–æœºæž„
        ![image.png](https://i.loli.net/2019/12/18/PigQGa5IV2nORmF.png)
            + ç¼ºç‚¹å°±æ˜¯åœ°å€å˜æ¢é€Ÿåº¦ä½Ž(ä¸¤æ¬¡è®¿é—®å†…å­˜)
        - å…·æœ‰å¿«è¡¨çš„åœ°å€å˜æ¢æœºæž„(è§£å†³ä¸Šè¿°ç¼ºç‚¹)
        ![image.png](https://i.loli.net/2019/12/18/u7VHSmqKXxs1Cwc.png)
    
    + æœ‰æ•ˆè®¿é—®æ—¶é—´(EAT,Effective Access Time)
        - ä»Žç»™å®šé€»è¾‘åœ°å€ï¼Œç»è¿‡åœ°å€å˜æ¢ï¼Œåˆ°å†…å­˜ä¸­æ‰¾åˆ°å¯¹åº”çš„ç‰©ç†åœ°å€å•å…ƒå¹¶å–å‡ºæ•°æ®æ‰€ç”¨çš„æ€»æ—¶é—´
        - åŸºæœ¬åœ°å€å˜æ¢æœºæž„æ‰€éœ€æ—¶é—´
            + è®¾$T_M$ä¸ºå†…å­˜è®¿é—®æ—¶é—´ , $ EAT = 2T_M$
        - å…·æœ‰å¿«è¡¨çš„åœ°å€å˜æ¢æœºæž„
            + è®¾ç½® $P_{TLB}$ ä¸ºå¿«è¡¨çš„å‘½ä¸­çŽ‡ï¼Œ$T_{TLB}$ ä¸ºå¿«è¡¨çš„è®¿é—®æ—¶é—´
            $$ EAT = P_{TLB}*(T_{TLB}+T_{M})+(1-P_{TLB}) *(T_{TLB}+2T_M) $$


2. åˆ†é¡µå¼å­˜å‚¨ç®¡ç†
    + åŸºæœ¬åˆ†é¡µå¼å­˜å‚¨ç®¡ç†
    ![image.png](https://i.loli.net/2019/12/18/PigQGa5IV2nORmF.png)
    + å¤šçº§é¡µè¡¨
        - è¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå¤–è¡¨å­˜ä¸€ä¸ªå†…è¡¨ï¼ŒðŸŽŽå¥—å¨ƒï¼Ÿï¼Ÿï¼Ÿ
    + åç½®é¡µè¡¨
        - ä¸€èˆ¬é¡µè¡¨æŒ‰ç…§é¡µå·æŽ’åºï¼Œåç½®é¡µè¡¨æŒ‰ç…§ç‰©ç†å—å·æŽ’åºï¼Œå†…å®¹æ˜¯é¡µå·På’Œè¿›ç¨‹å·pid

3. åˆ†æ®µå¼å­˜å‚¨ç®¡ç†

4. æ®µé¡µå¼å­˜å‚¨ç®¡ç†

> âš¡ **ä¹ é¢˜**

![image.png](https://i.loli.net/2019/12/18/VBeNHDuKP5joaiF.png)
